# 2.3 Advanced Statistical Analysis with ANOVA - Quick Reference

## ğŸ“Š ANOVA Fundamentals

### Key Concept

**ANOVA partitions total variation**: `Total Variation = Between-Group + Within-Group`

### When to Use ANOVA

- âœ… Comparing means across 3+ groups
- âœ… Testing effects of categorical factors
- âœ… Analyzing factorial experiments
- âŒ Only 2 groups (use t-test instead)
- âŒ Continuous predictors (use regression instead)

---

## ğŸ”¢ Essential Formulas

### One-Way ANOVA

```text
F = MSB/MSW = (SSB/(k-1))/(SSW/(N-k))

Where:
- SSB = Î£náµ¢(È³áµ¢ - È³)Â²  (Between groups)
- SSW = Î£Î£(yáµ¢â±¼ - È³áµ¢)Â²  (Within groups)
- SST = SSB + SSW      (Total)
- k = number of groups
- N = total sample size
```

### Effect Size (Eta-squared)

```text
Î·Â² = SSB/SST
- Small: Î·Â² â‰ˆ 0.01
- Medium: Î·Â² â‰ˆ 0.06  
- Large: Î·Â² â‰ˆ 0.14
```

### Two-Way ANOVA

```text
yáµ¢â±¼â‚– = Î¼ + Î±áµ¢ + Î²â±¼ + (Î±Î²)áµ¢â±¼ + Îµáµ¢â±¼â‚–

Where:
- Î±áµ¢ = main effect of factor A
- Î²â±¼ = main effect of factor B
- (Î±Î²)áµ¢â±¼ = interaction effect
```

### Sample Size (Power Analysis)

```text
Required n per group â‰ˆ 2ÏƒÂ²(zÎ±/2 + zÎ²)Â²/Î´Â²

Where:
- Î´ = minimum detectable difference
- Ïƒ = standard deviation
- zÎ±/2, zÎ² = critical values for Î± and Î²
```

---

## ğŸ¯ Assumptions Checklist

### âœ… Independence

- **Check**: Random sampling, no systematic bias
- **Test**: Durbin-Watson statistic (1.5 < DW < 2.5)
- **Fix**: Randomize order, block known sources

### âœ… Normality

- **Check**: Q-Q plots, histograms of residuals
- **Test**: Shapiro-Wilk (n < 5000), Anderson-Darling
- **Fix**: Transform data, use robust alternatives

### âœ… Homoscedasticity (Equal Variances)

- **Check**: Residuals vs fitted plot
- **Test**: Levene's test, Bartlett's test
- **Fix**: Transform data, Welch's ANOVA

### âœ… Linearity (Factorial Designs)

- **Check**: Interaction plots, residual patterns
- **Test**: Lack-of-fit test
- **Fix**: Add polynomial terms, transform variables

---

## ğŸ“ˆ Interpretation Guidelines

### F-Test Results

```text
If p < Î± (usually 0.05):
  â†’ Reject Hâ‚€: "At least one group differs"
  â†’ Proceed to post-hoc tests

If p â‰¥ Î±:
  â†’ Fail to reject Hâ‚€: "No evidence of differences"
  â†’ Check power, effect size
```

### Post-Hoc Tests

| **Method** | **When to Use** | **Control** |
|------------|-----------------|-------------|
| Tukey HSD | Equal group sizes, all pairwise | Family-wise error |
| Bonferroni | Unequal sizes, selected pairs | Family-wise error |
| Dunnett | Many-to-one comparisons | Family-wise error |
| Fisher LSD | Planned comparisons only | Per-comparison error |

### Interaction Interpretation

- **Parallel lines**: No interaction â†’ interpret main effects
- **Non-parallel lines**: Interaction present â†’ interpret carefully
- **Crossing lines**: Strong interaction â†’ main effects misleading

---

## âš™ï¸ Semiconductor Applications

### Tool Matching Study

```text
Hâ‚€: Î¼â‚ = Î¼â‚‚ = Î¼â‚ƒ = Î¼â‚„  (all tools equivalent)
Design: Balanced, randomized assignment
Analysis: One-way ANOVA + Tukey post-hoc
Criterion: Differences < engineering tolerance
```

### Process Optimization (2áµ Design)

```text
Factors: k process parameters (2 levels each)
Runs: 2áµ experiments (+ center points)
Model: y = Î²â‚€ + Î£Î²áµ¢xáµ¢ + Î£Î£Î²áµ¢â±¼xáµ¢xâ±¼ + Îµ
Goal: Identify significant effects
```

### Gauge R&R Analysis

```text
Components:
- Repeatability: Same operator variability
- Reproducibility: Between operator variability  
- Part-to-part: True process variation
Target: %R&R < 10% (excellent), < 30% (acceptable)
```

---

## ğŸš¨ Troubleshooting Guide

### Problem: ANOVA Not Significant, But Groups Look Different

**Causes**: Low power, high within-group variance, outliers

**Solutions**:

- Increase sample size
- Remove outliers
- Use blocking to reduce error variance
- Check for non-linear relationships

### Problem: Significant ANOVA, No Significant Post-Hoc

**Causes**: Conservative post-hoc correction, multiple small differences

**Solutions**:

- Use less conservative post-hoc (Fisher LSD)
- Plan specific contrasts
- Report effect sizes and confidence intervals

### Problem: Assumptions Violated

**Solutions by Violation**:

- **Non-normality**: Log transform, use Kruskal-Wallis
- **Unequal variances**: Welch ANOVA, robust methods
- **Non-independence**: Mixed-effects models, GLS

### Problem: Significant Interaction, Can't Interpret

**Solutions**:

- Plot interaction graphs
- Analyze simple effects (one factor at each level of other)
- Use contrast coding
- Consider three-way interactions

---

## ğŸ”§ Quick Commands (Python)

### One-Way ANOVA Commands

```python
from scipy.stats import f_oneway
from statsmodels.formula.api import ols
from statsmodels.stats.anova import anova_lm

# Basic test
groups = [data[data['tool']==t]['yield'] for t in tools]
f_stat, p_value = f_oneway(*groups)

# Detailed analysis
model = ols('yield ~ C(tool)', data=data).fit()
anova_table = anova_lm(model, typ=2)
```

### Post-Hoc Test Commands

```python
from statsmodels.stats.multicomp import pairwise_tukeyhsd

tukey_results = pairwise_tukeyhsd(data['yield'], data['tool'])
print(tukey_results)
```

### Assumption Test Commands

```python
from scipy.stats import shapiro, levene

# Normality
shapiro_stat, shapiro_p = shapiro(residuals)

# Equal variances
levene_stat, levene_p = levene(*groups)
```

### Power Analysis Commands

```python
from statsmodels.stats.power import FTestAnovaPower

power_calc = FTestAnovaPower()
n_required = power_calc.solve_power(
    effect_size=0.25, alpha=0.05, power=0.80, k_groups=4
)
```

---

## ğŸ“Š Effect Size Guidelines

### Cohen's Conventions

| **Î·Â²** | **Cohen's f** | **Interpretation** | **Example** |
|--------|---------------|-------------------|-------------|
| 0.01 | 0.10 | Small | Tool differences within spec |
| 0.06 | 0.25 | Medium | Noticeable process improvement |
| 0.14 | 0.40 | Large | Major process change needed |

### Practical Significance

```text
Statistical significance â‰  Practical importance

Consider:
- Engineering tolerances
- Cost of implementation  
- Business impact
- Risk assessment
```

---

## ğŸ¯ Decision Tree

```text
Start: Do you want to compare group means?
â”œâ”€ YES: Continue
â””â”€ NO: Use regression/correlation

How many groups?
â”œâ”€ 2 groups: Use t-test
â”œâ”€ 3+ groups: Continue
â””â”€ Continuous predictor: Use regression

How many factors?
â”œâ”€ 1 factor: One-way ANOVA
â”œâ”€ 2-3 factors: Multi-way ANOVA
â””â”€ 4+ factors: Factorial design

Are assumptions met?
â”œâ”€ YES: Proceed with ANOVA
â”œâ”€ NO (normality): Kruskal-Wallis
â”œâ”€ NO (equal variance): Welch ANOVA
â””â”€ NO (independence): Mixed-effects model

Is ANOVA significant?
â”œâ”€ YES: Post-hoc tests
â””â”€ NO: Check power, effect size

Practical significance?
â”œâ”€ YES: Implement changes
â””â”€ NO: Cost-benefit analysis
```

---

## ğŸš€ Best Practices

### Experimental Design

1. **Plan first**: Define hypotheses, calculate sample sizes
2. **Randomize**: Control order effects and bias
3. **Block**: Account for known sources of variation
4. **Replicate**: Enable error estimation and increase power

### Analysis Strategy

1. **Explore first**: Descriptive statistics, plots
2. **Check assumptions**: Don't skip this step
3. **Report effect sizes**: Not just p-values
4. **Use confidence intervals**: Show uncertainty

### Manufacturing Context

1. **Consider costs**: Statistical vs practical significance
2. **Document everything**: Reproducible analyses
3. **Validate results**: Independent confirmation
4. **Monitor over time**: Trends and drift

---

## ğŸ“š Common Mistakes to Avoid

âŒ **Multiple t-tests instead of ANOVA** â†’ Inflated Type I error  
âŒ **Ignoring interactions** â†’ Misinterpreted main effects  
âŒ **No assumption checking** â†’ Invalid conclusions  
âŒ **Fishing for significance** â†’ Multiple testing issues  
âŒ **Confusing statistical and practical significance** â†’ Poor decisions  
âŒ **Unbalanced designs without justification** â†’ Reduced power  
âŒ **Post-hoc tests without significant ANOVA** â†’ Inappropriate  

---

## ğŸ”— Next Steps

**Module 3.1**: Regression Analysis for Process Engineers

- Predictive modeling
- Continuous variable relationships  
- Process optimization
- Model validation

**Advanced Topics**:

- Mixed-effects models
- Repeated measures
- Multivariate ANOVA (MANOVA)
- Bayesian ANOVA
